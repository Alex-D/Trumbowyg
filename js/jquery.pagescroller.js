var pageScroller={};(function(a){a.fn.extend({pageScroller:function(d){d=a.extend({currentSection:0,sectionClass:"section",linkClass:"link",navigation:[],navigationClass:"standardNav light",navigationLabel:"Navigation",animationSpeed:500,animationType:"swing",scrollOffset:0,HTML5mode:!1,deepLink:!1,keyboardControl:!0,animationBefore:function(){},animationComplete:function(){},onChange:function(){}},d);pageScroll=function(g,j){a.fx.interval=5;pageScroller.scrollDocument=a(document);pageScroller.scrollWindow=a(window);pageScroller.scrollBody=a("body");pageScroller.scrollPosition=pageScroller.scrollWindow.scrollTop();pageScroller.currentSectionHeight=pageScroller.scrollWindow.height();pageScroller.options=j;pageScroller.options.scrollOffset=parseInt(pageScroller.options.scrollOffset);var h="div";j.HTML5mode&&(h="nav");pageScroller.options.navigation instanceof Array&&(g.append("<"+h+' class="pageScrollerNav '+j.navigationClass+'"><ul></ul></'+h+">"),pageScroller.wrapper=a("."+j.navigationClass.replace(/\s/g,"."),g),pageScroller.navigation=a("ul",pageScroller.wrapper),pageScroller.wrapper.addClass("left"),g.css({position:"relative"}));pageScroller.sections=j.HTML5mode?a("section",g):a("."+j.sectionClass,g);pageScroller.sections.each(function(k){var l=a(this),n=pageScroller.sections.eq(k).attr("title"),m=j.linkClass+" "+j.linkClass+"_"+(k+1);k==pageScroller.sections.length-1&&(m+=" "+j.linkClass+"_last");l.css({display:"block",position:"relative","float":"none"});l.addClass(pageScroller.options.sectionClass+"_"+(k+1));pageScroller.options.navigation instanceof Array?pageScroller.options.navigation.length?pageScroller.navigation.append('<li class="'+m+'"><a href="#pageScroll'+k+'">'+pageScroller.options.navigation[k]+"</a></li>"):n&&""!=n?pageScroller.navigation.append('<li class="'+m+'"><a href="#pageScroll'+k+'">'+n+"</a></li>"):pageScroller.navigation.append('<li class="'+m+'"><a href="#pageScroll'+k+'">Navigation '+(k+1)+"</a></li>"):pageScroller.navigation=a(pageScroller.options.navigation)});pageScroller.pageLinks=a("a.scroller",pageScroller.navigation);pageScroller.pageLinks.each(function(k){a(this).bind("click",function(l){l.preventDefault();j.animationBefore();pageScroller.scrollBody.is(":animated")||(pageScroller.pageLinks.parent("li").removeClass("active"),a(this).parent("li").addClass("active"));f(g,pageScroller.sections.eq(k),k)})});pageScroller.next=function(){var k=pageScroller.options.currentSection+1;if(k!=pageScroller.sections.length){var l=pageScroller.sections.eq(k);f(g,l,k)}};pageScroller.prev=function(){var k=pageScroller.options.currentSection-1;0>=k&&(k=0);var l=pageScroller.sections.eq(k);f(g,l,k)};pageScroller.goTo=function(k){var k=k-1,l=pageScroller.sections.eq(k);f(g,l,k)};pageScroller.options.keyboardControl&&pageScroller.scrollDocument.bind("keydown",function(k){var l=k.which?k.which:k.keyCode;if(38==l||40==l){k.preventDefault(),38==l?pageScroller.options.currentSection?pageScroller.goTo(pageScroller.options.currentSection):pageScroller.goTo(pageScroller.options.currentSection+1):40==l&&(pageScroller.options.currentSection+1==pageScroller.sections.length?pageScroller.goTo(pageScroller.options.currentSection+1):pageScroller.goTo(pageScroller.options.currentSection+2))}});pageScroller.scrollWindow.bind("scroll",function(){c()});setTimeout(function(){0==pageScroller.scrollPosition&&b();c()},200)};var b=function(){if(pageScroller.options.deepLink){var g=window.location.hash;g&&pageScroller.pageLinks.each(function(j){var h=pageScroller.pageLinks.eq(j);h=(h.is('[href^="#"]')&&h.attr("href")!="#")?h.attr("href"):"#"+h.html().replace(/[^a-zA-Z 0-9]+/g,"").replace(/\s+/g,"-").toLowerCase();if(g==h){return pageScroller.goTo(j+1),!1}})}},c=function(){pageScroller.scrollPosition=pageScroller.scrollWindow.scrollTop();pageScroller.scrollDistance=pageScroller.scrollPosition+pageScroller.currentSectionHeight;for(i=0;i<pageScroller.sections.length;i++){var h=pageScroller.sections.eq(i).offset().top;pageScroller.options.scrollOffset&&h&&(h+=parseInt(pageScroller.options.scrollOffset));var k=0;if(i<pageScroller.sections.length-1){var j=pageScroller.sections.eq(i+1);pageScroller.options.scrollOffset?k=parseInt(j.offset().top+pageScroller.options.scrollOffset):k=j.offset().top;var j=pageScroller.pageLinks.eq(i).parent("li"),g=pageScroller.pageLinks.eq(pageScroller.sections.length-1).parent("li")}if(pageScroller.scrollBody.is(":animated")){return !1}if(pageScroller.scrollDocument.height()==pageScroller.scrollDistance){if(!g.hasClass("active")){return updateTo=pageScroller.sections.length-1,e(updateTo),!1}}else{if(k){if(pageScroller.scrollPosition>=h&&pageScroller.scrollPosition<k&&!j.hasClass("active")){return updateTo=i,e(updateTo),!1}}else{if(pageScroller.scrollPosition>=h&&i==pageScroller.sections.length-1&&!g.hasClass("active")){return updateTo=pageScroller.sections.length-1,e(updateTo),!1}}}}},f=function(h,k,j){var h=a("html, body"),g=a(window).scrollTop(),k=k.offset().top;parseInt(pageScroller.options.scrollOffset)&&(k+=parseInt(pageScroller.options.scrollOffset));0>k&&(k=0);k!=g&&!h.is(":animated")&&h.animate({scrollTop:k},pageScroller.options.animationSpeed,pageScroller.options.animationType).promise().done(function(){e(j);pageScroller.options.animationComplete()})},e=function(g){pageScroller.pageLinks.parent("li").removeClass("active");pageScroller.pageLinks.eq(g).parent("li").addClass("active");pageScroller.options.currentSection=g;pageScroller.options.deepLink&&(psa=pageScroller.pageLinks.eq(g),g=(psa.is('[href^="#"]')&&psa.attr("href")!="#")?psa.attr("href").replace(/\#/,""):psa.html().replace(/[^a-zA-Z 0-9]+/g,"").replace(/\s+/g,"-").toLowerCase(),window.location.hash=g);pageScroller.options.onChange()};if(!pageScroller.options){return pageScroll(this,d)}}})})(jQuery);